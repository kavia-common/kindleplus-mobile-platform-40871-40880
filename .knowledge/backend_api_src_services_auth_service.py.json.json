{"is_source_file": true, "format": "Python", "description": "This file provides authentication services for a FastAPI application, including password hashing, JWT token creation and decoding, and user authentication dependencies.", "external_files": ["src.core.config", "src.db.session", "src.models.user", "fastapi", "fastapi.security", "jose", "passlib.context", "sqlalchemy"], "external_methods": ["get_settings", "get_db", "select", "jwt.encode", "jwt.decode"], "published": ["get_password_hash", "verify_password", "create_access_token", "create_refresh_token", "create_token_pair_for_user", "decode_token", "get_token_payload", "get_current_user"], "classes": [{"name": "User", "description": "User model class imported from src.models.user"}], "methods": [{"name": "get_password_hash", "description": "Hash a plaintext password using bcrypt via passlib."}, {"name": "verify_password", "description": "Verify a plaintext password against its hashed value."}, {"name": "_create_token", "description": "Create a JWT token with the given subject and expiry."}, {"name": "create_access_token", "description": "Create a short-lived access token."}, {"name": "create_refresh_token", "description": "Create a long-lived refresh token."}, {"name": "create_token_pair_for_user", "description": "Create an access and refresh token pair for a given user."}, {"name": "decode_token", "description": "Decode and validate a JWT token, returning the payload if valid."}, {"name": "get_token_payload", "description": "Decode a token and (optionally) assert its type."}, {"name": "get_current_user", "description": "FastAPI dependency that resolves the current authenticated user from a bearer token."}], "calls": ["jwt.encode", "jwt.decode", "get_settings", "get_db", "select", "HTTPException", "get_settings", "get_settings"], "search-terms": ["auth_service", "JWT token creation", "FastAPI authentication", "password hashing", "OAuth2PasswordBearer"], "state": 2, "file_id": 31, "knowledge_revision": 129, "git_revision": "c0fca5e09ca498202521756180ddc1f2d45a28b2", "revision_history": [{"72": ""}, {"129": "c0fca5e09ca498202521756180ddc1f2d45a28b2"}], "ctags": [], "filename": "backend_api/src/services/auth_service.py", "format-version": 4, "code-base-name": "https://github.com/kavia-common/kindleplus-mobile-platform-40871-40880.git:kavia-main"}