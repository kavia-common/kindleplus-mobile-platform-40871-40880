{"is_source_file": true, "format": "Python", "description": "This source file defines API route handlers for managing user wishlists, including listing, adding, retrieving, and removing wishlist entries. It uses FastAPI, SQLAlchemy, and Pydantic to implement CRUD operations for wishlist-related data.", "external_files": ["src/db/session.py", "src/models/book.py", "src/models/user.py", "src/models/wishlist.py", "src/schemas/wishlist.py", "src/services/auth_service.py", "src/utils/pagination.py"], "external_methods": ["get_db", "get_current_user", "PageMeta.build", "sanitize_pagination", "offset_limit"], "published": ["list_wishlist", "add_to_wishlist", "get_wishlist_entry", "remove_from_wishlist"], "classes": [{"name": "WishlistAddRequest", "description": "Request payload model for adding a book to the wishlist."}], "methods": [{"name": "Select _query_user_wishlist_base(user_id: str)", "description": "Internal helper to build base SQLAlchemy select for a user's wishlist with relationships preloaded.", "scope": "", "scopeKind": ""}, {"name": "Paginated[WishlistRead] list_wishlist( page: int = Query(default=1, ge=1, description=\"Page number (1-based)\"), page_size: int = Query(default=20, ge=1, le=100, description=\"Items per page\"), db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )", "description": "API handler to list the wishlist entries for the authenticated user with pagination.", "scope": "", "scopeKind": ""}, {"name": "WishlistRead add_to_wishlist( payload: WishlistAddRequest, db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )", "description": "API handler to add a new book to the authenticated user's wishlist.", "scope": "", "scopeKind": ""}, {"name": "WishlistRead get_wishlist_entry( entry_id: str, db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )", "description": "API handler to retrieve details of a specific wishlist entry by ID.", "scope": "", "scopeKind": ""}, {"name": "None remove_from_wishlist( entry_id: str, db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )", "description": "API handler to remove a wishlist entry by ID.", "scope": "", "scopeKind": ""}], "calls": ["select(Wishlist)", "selectinload(Wishlist.book)", "selectinload(Wishlist.user)", "db.scalar", "db.execute", "db.get", "db.add", "db.commit", "db.refresh", "db.delete"], "search-terms": ["wishlist", "add_to_wishlist", "list_wishlist", "get_wishlist_entry", "remove_from_wishlist", "pagination", "FastAPI routers"], "state": 2, "file_id": 40, "knowledge_revision": 95, "git_revision": "", "ctags": [{"_type": "tag", "name": "PydBaseModel", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/wishlist.py", "pattern": "/^from pydantic import BaseModel as PydBaseModel$/", "language": "Python", "kind": "unknown", "nameref": "unknown:BaseModel"}, {"_type": "tag", "name": "WishlistAddRequest", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/wishlist.py", "pattern": "/^class WishlistAddRequest(PydBaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_query_user_wishlist_base", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/wishlist.py", "pattern": "/^def _query_user_wishlist_base(user_id: str) -> Select:$/", "language": "Python", "typeref": "typename:Select", "kind": "function", "signature": "(user_id: str)"}, {"_type": "tag", "name": "add_to_wishlist", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/wishlist.py", "pattern": "/^def add_to_wishlist($/", "language": "Python", "typeref": "typename:WishlistRead", "kind": "function", "signature": "( payload: WishlistAddRequest, db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )"}, {"_type": "tag", "name": "book_id", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/wishlist.py", "pattern": "/^    book_id: str = Field(..., description=\"Book ID to add to wishlist\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "WishlistAddRequest", "scopeKind": "class"}, {"_type": "tag", "name": "get_wishlist_entry", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/wishlist.py", "pattern": "/^def get_wishlist_entry($/", "language": "Python", "typeref": "typename:WishlistRead", "kind": "function", "signature": "( entry_id: str, db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )"}, {"_type": "tag", "name": "list_wishlist", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/wishlist.py", "pattern": "/^def list_wishlist($/", "language": "Python", "typeref": "typename:Paginated[WishlistRead]", "kind": "function", "signature": "( page: int = Query(default=1, ge=1, description=\"Page number (1-based)\"), page_size: int = Query(default=20, ge=1, le=100, description=\"Items per page\"), db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )"}, {"_type": "tag", "name": "remove_from_wishlist", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/wishlist.py", "pattern": "/^def remove_from_wishlist($/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "( entry_id: str, db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/wishlist.py", "pattern": "/^router = APIRouter(prefix=\"\\/wishlist\", tags=[\"Wishlist\"])$/", "language": "Python", "kind": "variable"}], "hash": "c996cfb04197e5cbe82188c445018a5e", "format-version": 4, "code-base-name": "backend_api", "filename": "backend_api/src/api/routers/wishlist.py", "fields": [{"name": "str book_id", "scope": "WishlistAddRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/wishlist\", tags=[\"Wishlist\"])", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"95": ""}]}