{"is_source_file": true, "format": "Python", "description": "This file defines FastAPI route handlers for managing books, including listing, creating, retrieving, updating, and deleting books; it also contains filter application logic for querying books with various search parameters.", "external_files": ["src/db/session.py", "src/models/book.py", "src/models/category.py", "src/schemas/book.py", "src/utils/pagination.py"], "external_methods": ["get_db", "Book.model_validate", "PageMeta.build", "sanitize_pagination", "select", "selectinload", "func.count", "db.execute", "db.add", "db.commit", "db.refresh", "db.get", "db.delete", "HTTPException"], "published": ["list_books", "create_book", "get_book", "update_book", "delete_book"], "classes": [{"name": "APIRouter", "description": "FastAPI class for defining a collection of API routes."}], "methods": [{"name": "_apply_book_filters( base_stmt, *, q: Optional[str], author: Optional[str], category_id: Optional[str], category_slug: Optional[str], price_min: Optional[int], price_max: Optional[int], )", "description": "Applies search and filter conditions to a SQLAlchemy select statement for books, returning the modified statement and a flag indicating if a join was used.", "scope": "", "scopeKind": ""}, {"name": "Paginated[BookRead] list_books( q: Optional[str] = Query(default=None, description=\"Search text across title, author, and description\"), author: Optional[str] = Query(default=None, description=\"Filter by author (partial match)\"), category_id: Optional[str] = Query(default=None, description=\"Filter by category ID\"), category_slug: Optional[str] = Query(default=None, description=\"Filter by category slug\"), price_min: Optional[int] = Query(default=None, ge=0, description=\"Minimum price in cents\"), price_max: Optional[int] = Query(default=None, ge=0, description=\"Maximum price in cents\"), page: int = Query(default=1, ge=1, description=\"Page number (1-based)\"), page_size: int = Query(default=20, ge=1, le=100, description=\"Items per page\"), db: Session = Depends(get_db), )", "description": "GET endpoint that lists books with optional search filters and supports pagination.", "scope": "", "scopeKind": ""}, {"name": "BookRead create_book(payload: BookCreate, db: Session = Depends(get_db))", "description": "POST endpoint to create a new book entry.", "scope": "", "scopeKind": ""}, {"name": "BookRead get_book(book_id: str, db: Session = Depends(get_db))", "description": "GET endpoint to retrieve a book by its ID.", "scope": "", "scopeKind": ""}, {"name": "BookRead update_book(book_id: str, payload: BookUpdate, db: Session = Depends(get_db))", "description": "PATCH endpoint to update mutable fields of an existing book.", "scope": "", "scopeKind": ""}, {"name": "None delete_book(book_id: str, db: Session = Depends(get_db))", "description": "DELETE endpoint to remove a book by its ID.", "scope": "", "scopeKind": ""}], "calls": ["get_db", "select", "selectinload", "func.count", "db.execute", "PageMeta.build", "sanitize_pagination", "Book.model_validate", "db.add", "db.commit", "db.refresh", "db.get", "db.delete", "HTTPException"], "search-terms": ["FastAPI", "Book", "BookRead", "books.py", "filter application", "pagination", "category filter", "search query", "book CRUD"], "state": 2, "file_id": 39, "knowledge_revision": 92, "git_revision": "", "ctags": [{"_type": "tag", "name": "_apply_book_filters", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/books.py", "pattern": "/^def _apply_book_filters($/", "language": "Python", "kind": "function", "signature": "( base_stmt, *, q: Optional[str], author: Optional[str], category_id: Optional[str], category_slug: Optional[str], price_min: Optional[int], price_max: Optional[int], )"}, {"_type": "tag", "name": "create_book", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/books.py", "pattern": "/^def create_book(payload: BookCreate, db: Session = Depends(get_db)) -> BookRead:$/", "language": "Python", "typeref": "typename:BookRead", "kind": "function", "signature": "(payload: BookCreate, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "delete_book", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/books.py", "pattern": "/^def delete_book(book_id: str, db: Session = Depends(get_db)) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(book_id: str, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "get_book", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/books.py", "pattern": "/^def get_book(book_id: str, db: Session = Depends(get_db)) -> BookRead:$/", "language": "Python", "typeref": "typename:BookRead", "kind": "function", "signature": "(book_id: str, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "list_books", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/books.py", "pattern": "/^def list_books($/", "language": "Python", "typeref": "typename:Paginated[BookRead]", "kind": "function", "signature": "( q: Optional[str] = Query(default=None, description=\"Search text across title, author, and description\"), author: Optional[str] = Query(default=None, description=\"Filter by author (partial match)\"), category_id: Optional[str] = Query(default=None, description=\"Filter by category ID\"), category_slug: Optional[str] = Query(default=None, description=\"Filter by category slug\"), price_min: Optional[int] = Query(default=None, ge=0, description=\"Minimum price in cents\"), price_max: Optional[int] = Query(default=None, ge=0, description=\"Maximum price in cents\"), page: int = Query(default=1, ge=1, description=\"Page number (1-based)\"), page_size: int = Query(default=20, ge=1, le=100, description=\"Items per page\"), db: Session = Depends(get_db), )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/books.py", "pattern": "/^router = APIRouter(prefix=\"\\/books\", tags=[\"Books\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "update_book", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/books.py", "pattern": "/^def update_book(book_id: str, payload: BookUpdate, db: Session = Depends(get_db)) -> BookRead:$/", "language": "Python", "typeref": "typename:BookRead", "kind": "function", "signature": "(book_id: str, payload: BookUpdate, db: Session = Depends(get_db))"}], "hash": "c1fbfa2bf5bf8ad242bbd58a03038094", "format-version": 4, "code-base-name": "backend_api", "filename": "backend_api/src/api/routers/books.py", "fields": [{"name": "router = APIRouter(prefix=\"\\/books\", tags=[\"Books\"])", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"92": ""}]}