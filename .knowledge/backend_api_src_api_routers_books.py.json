{"is_source_file": true, "format": "Python", "description": "This file defines API routes related to book operations such as listing, creating, retrieving, updating, and deleting books in a FastAPI application. It includes functions for filtering, pagination, and handling database interactions via SQLAlchemy models.", "external_files": ["src/db/session.py", "src/models/book.py", "src/models/category.py", "src/schemas/book.py", "src/utils/pagination.py"], "external_methods": ["get_db", "Book.model_validate", "PageMeta.build", "sanitize_pagination", "selectinload", "select", "func.count", "or_", "and_", "raise HTTPException", "list", "list.execute", "list.scalar", "list.scalars", "list.commit", "list.refresh", "list.delete"], "published": ["list_books", "create_book", "get_book", "update_book", "delete_book"], "classes": [{"name": "APIRouter", "description": "FastAPI's router class for defining route groups, used here to organize book-related endpoints."}], "methods": [{"name": "_apply_book_filters( base_stmt, *, q: Optional[str], author: Optional[str], category_id: Optional[str], category_slug: Optional[str], price_min: Optional[int], price_max: Optional[int], )", "description": "Applies search and filter conditions to a SQLAlchemy select statement for retrieving books, incorporating optional filters for search text, author, category, and price range.", "scope": "", "scopeKind": ""}, {"name": "BookRead create_book(payload: BookCreate, db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Response delete_book(book_id: str, db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "BookRead get_book(book_id: str, db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Paginated[BookRead] list_books( q: Optional[str] = Query(default=None, description=\"Search text across title, author, and description\"), author: Optional[str] = Query(default=None, description=\"Filter by author (partial match)\"), category_id: Optional[str] = Query(default=None, description=\"Filter by category ID\"), category_slug: Optional[str] = Query(default=None, description=\"Filter by category slug\"), price_min: Optional[int] = Query(default=None, ge=0, description=\"Minimum price in cents\"), price_max: Optional[int] = Query(default=None, ge=0, description=\"Maximum price in cents\"), page: int = Query(default=1, ge=1, description=\"Page number (1-based)\"), page_size: int = Query(default=20, ge=1, le=100, description=\"Items per page\"), db: Session = Depends(get_db), )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "BookRead update_book(book_id: str, payload: BookUpdate, db: Session = Depends(get_db))", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["select", "selectinload", "func.count", "db.execute", "db.get", "db.add", "db.commit", "db.refresh", "db.delete", "HTTPException"], "search-terms": ["books API", "filter by category", "pagination", "search by author", "price range filter", "FastAPI books routes"], "state": 2, "file_id": 39, "knowledge_revision": 105, "git_revision": "eafdfe0112b14a75f43b90fb8cb6069d7079c4c2", "revision_history": [{"92": ""}, {"104": "eafdfe0112b14a75f43b90fb8cb6069d7079c4c2"}, {"105": "eafdfe0112b14a75f43b90fb8cb6069d7079c4c2"}], "ctags": [{"_type": "tag", "name": "_apply_book_filters", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/books.py", "pattern": "/^def _apply_book_filters($/", "language": "Python", "kind": "function", "signature": "( base_stmt, *, q: Optional[str], author: Optional[str], category_id: Optional[str], category_slug: Optional[str], price_min: Optional[int], price_max: Optional[int], )"}, {"_type": "tag", "name": "create_book", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/books.py", "pattern": "/^def create_book(payload: BookCreate, db: Session = Depends(get_db)) -> BookRead:$/", "language": "Python", "typeref": "typename:BookRead", "kind": "function", "signature": "(payload: BookCreate, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "delete_book", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/books.py", "pattern": "/^def delete_book(book_id: str, db: Session = Depends(get_db)) -> Response:$/", "language": "Python", "typeref": "typename:Response", "kind": "function", "signature": "(book_id: str, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "get_book", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/books.py", "pattern": "/^def get_book(book_id: str, db: Session = Depends(get_db)) -> BookRead:$/", "language": "Python", "typeref": "typename:BookRead", "kind": "function", "signature": "(book_id: str, db: Session = Depends(get_db))"}, {"_type": "tag", "name": "list_books", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/books.py", "pattern": "/^def list_books($/", "language": "Python", "typeref": "typename:Paginated[BookRead]", "kind": "function", "signature": "( q: Optional[str] = Query(default=None, description=\"Search text across title, author, and description\"), author: Optional[str] = Query(default=None, description=\"Filter by author (partial match)\"), category_id: Optional[str] = Query(default=None, description=\"Filter by category ID\"), category_slug: Optional[str] = Query(default=None, description=\"Filter by category slug\"), price_min: Optional[int] = Query(default=None, ge=0, description=\"Minimum price in cents\"), price_max: Optional[int] = Query(default=None, ge=0, description=\"Maximum price in cents\"), page: int = Query(default=1, ge=1, description=\"Page number (1-based)\"), page_size: int = Query(default=20, ge=1, le=100, description=\"Items per page\"), db: Session = Depends(get_db), )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/books.py", "pattern": "/^router = APIRouter(prefix=\"\\/books\", tags=[\"Books\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "update_book", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/api/routers/books.py", "pattern": "/^def update_book(book_id: str, payload: BookUpdate, db: Session = Depends(get_db)) -> BookRead:$/", "language": "Python", "typeref": "typename:BookRead", "kind": "function", "signature": "(book_id: str, payload: BookUpdate, db: Session = Depends(get_db))"}], "hash": "7b457930d68e49860860ee3ab6a84445", "format-version": 4, "code-base-name": "backend_api", "filename": "backend_api/src/api/routers/books.py", "fields": [{"name": "router = APIRouter(prefix=\"\\/books\", tags=[\"Books\"])", "scope": "", "scopeKind": "", "description": "unavailable"}]}