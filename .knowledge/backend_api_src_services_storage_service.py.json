{"is_source_file": true, "format": "Python", "description": "This file defines an interface and multiple implementations for storage backends, including local filesystem, S3, and Google Cloud Storage. It includes methods for generating presigned URLs for upload and download operations, along with concrete classes for specific storage services.", "external_files": ["../core/config"], "external_methods": ["settings.STORAGE_BACKEND", "settings.S3_BUCKET", "settings.S3_REGION", "settings.S3_ACCESS_KEY_ID", "settings.S3_SECRET_ACCESS_KEY", "settings.GCS_BUCKET", "settings.GCS_CREDENTIALS_JSON", "settings.STORAGE_LOCAL_DIR"], "published": ["get_storage"], "classes": [{"name": "StorageBackend", "description": "Protocol interface for storage backends, defining methods for presigned upload and download URL generation."}, {"name": "LocalStorage", "description": "Concrete implementation of StorageBackend for local filesystem storage, emulating presigned URLs."}, {"name": "S3Storage", "description": "Concrete implementation for Amazon S3 storage, generating presigned URLs for upload and download."}, {"name": "GCSStorage", "description": "Concrete implementation for Google Cloud Storage, generating presigned URLs."}], "methods": [{"name": "Tuple[str,dict] presign_upload(self, key: str, expires_in: int = 600)", "description": "Generates a presigned URL and fields for uploading files.", "scope": "StorageBackend", "scopeKind": "class"}, {"name": "str presign_download(self, key: str, expires_in: int = 600)", "description": "Generates a presigned URL for downloading files.", "scope": "StorageBackend", "scopeKind": "class"}, {"name": "StorageBackend get_storage()", "description": "Factory function returning a configured storage backend based on settings.", "scope": "", "scopeKind": ""}, {"name": "str _full_path(self, key: str)", "scope": "LocalStorage", "scopeKind": "class", "description": "unavailable"}], "calls": ["settings.STORAGE_BACKEND.lower()", "settings.S3_BUCKET", "settings.S3_REGION", "settings.S3_ACCESS_KEY_ID", "settings.S3_SECRET_ACCESS_KEY", "settings.GCS_BUCKET", "settings.GCS_CREDENTIALS_JSON", "settings.STORAGE_LOCAL_DIR"], "search-terms": ["storage backend interface", "presigned URL generator", "local storage implementation", "S3 presign", "GCS presign", "storage factory"], "state": 2, "file_id": 44, "knowledge_revision": 112, "git_revision": "", "ctags": [{"_type": "tag", "name": "GCSStorage", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^class GCSStorage(StorageBackend):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "LocalStorage", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^class LocalStorage(StorageBackend):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "S3Storage", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^class S3Storage(StorageBackend):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "StorageBackend", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^class StorageBackend(Protocol):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_full_path", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def _full_path(self, key: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, key: str)", "scope": "LocalStorage", "scopeKind": "class"}, {"_type": "tag", "name": "get_storage", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^def get_storage() -> StorageBackend:$/", "language": "Python", "typeref": "typename:StorageBackend", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "presign_download", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_download(self, key: str, expires_in: int = 600) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "GCSStorage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_download", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_download(self, key: str, expires_in: int = 600) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "LocalStorage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_download", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_download(self, key: str, expires_in: int = 600) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "S3Storage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_download", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_download(self, key: str, expires_in: int = 600) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "StorageBackend", "scopeKind": "class"}, {"_type": "tag", "name": "presign_upload", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_upload(self, key: str, expires_in: int = 600) -> Tuple[str, dict]:$/", "language": "Python", "typeref": "typename:Tuple[str,dict]", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "GCSStorage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_upload", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_upload(self, key: str, expires_in: int = 600) -> Tuple[str, dict]:$/", "language": "Python", "typeref": "typename:Tuple[str,dict]", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "LocalStorage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_upload", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_upload(self, key: str, expires_in: int = 600) -> Tuple[str, dict]:$/", "language": "Python", "typeref": "typename:Tuple[str,dict]", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "S3Storage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_upload", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_upload(self, key: str, expires_in: int = 600) -> Tuple[str, dict]:$/", "language": "Python", "typeref": "typename:Tuple[str,dict]", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "StorageBackend", "scopeKind": "class"}], "hash": "c89b0a9243dcb910bb5cdfe370b191c7", "format-version": 4, "code-base-name": "backend_api", "filename": "backend_api/src/services/storage_service.py", "revision_history": [{"112": ""}]}