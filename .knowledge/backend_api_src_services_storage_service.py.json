{"is_source_file": true, "format": "Python", "description": "This file defines storage backend interfaces and implementations for local storage, AWS S3, and Google Cloud Storage, along with a factory method to select the storage backend based on configuration.", "external_files": ["src.core.config"], "external_methods": ["settings.storage_backend", "settings.s3_bucket", "settings.s3_region", "settings.s3_access_key_id", "settings.s3_secret_access_key", "settings.gcs_bucket", "settings.gcs_credentials_json", "settings.storage_local_dir"], "published": ["get_storage"], "classes": [{"name": "StorageBackend", "description": "A Protocol defining the interface for storage backends with methods for presigning uploads and downloads."}, {"name": "LocalStorage", "description": "Implementation of StorageBackend for local filesystem storage."}, {"name": "S3Storage", "description": "Implementation of StorageBackend for AWS S3 storage."}, {"name": "GCSStorage", "description": "Implementation of StorageBackend for Google Cloud Storage."}], "methods": [{"name": "Tuple[str,dict] presign_upload(self, key: str, expires_in: int = 600)", "description": "Generates a presigned URL or access parameters for uploading a file, implementation varies by backend.", "scope": "StorageBackend", "scopeKind": "class"}, {"name": "str presign_download(self, key: str, expires_in: int = 600)", "description": "Generates a presigned URL for downloading a file, implementation varies by backend.", "scope": "StorageBackend", "scopeKind": "class"}, {"name": "StorageBackend get_storage()", "description": "Factory function that returns a storage backend instance based on the application's configuration.", "scope": "", "scopeKind": ""}, {"name": "str _full_path(self, key: str)", "scope": "LocalStorage", "scopeKind": "class", "description": "unavailable"}], "calls": ["settings.storage_backend", "settings.s3_bucket", "settings.s3_region", "settings.s3_access_key_id", "settings.s3_secret_access_key", "settings.gcs_bucket", "settings.gcs_credentials_json", "settings.storage_local_dir", "os.makedirs", "datetime.now", "hashlib.sha256", "hmac.new", "urlencode"], "search-terms": ["storage backend", "presign URL", "local storage", "AWS S3", "Google Cloud Storage", "factory method storage"], "state": 2, "file_id": 44, "knowledge_revision": 156, "git_revision": "55299610ad3eceeba2da47c02fa820d21e779ef8", "revision_history": [{"112": ""}, {"138": "55299610ad3eceeba2da47c02fa820d21e779ef8"}, {"156": "55299610ad3eceeba2da47c02fa820d21e779ef8"}], "ctags": [{"_type": "tag", "name": "GCSStorage", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^class GCSStorage(StorageBackend):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "LocalStorage", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^class LocalStorage(StorageBackend):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "S3Storage", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^class S3Storage(StorageBackend):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "StorageBackend", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^class StorageBackend(Protocol):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_full_path", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def _full_path(self, key: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, key: str)", "scope": "LocalStorage", "scopeKind": "class"}, {"_type": "tag", "name": "get_storage", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^def get_storage() -> StorageBackend:$/", "language": "Python", "typeref": "typename:StorageBackend", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "presign_download", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_download(self, key: str, expires_in: int = 600) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "GCSStorage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_download", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_download(self, key: str, expires_in: int = 600) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "LocalStorage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_download", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_download(self, key: str, expires_in: int = 600) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "S3Storage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_download", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_download(self, key: str, expires_in: int = 600) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "StorageBackend", "scopeKind": "class"}, {"_type": "tag", "name": "presign_upload", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_upload(self, key: str, expires_in: int = 600) -> Tuple[str, dict]:$/", "language": "Python", "typeref": "typename:Tuple[str,dict]", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "GCSStorage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_upload", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_upload(self, key: str, expires_in: int = 600) -> Tuple[str, dict]:$/", "language": "Python", "typeref": "typename:Tuple[str,dict]", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "LocalStorage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_upload", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_upload(self, key: str, expires_in: int = 600) -> Tuple[str, dict]:$/", "language": "Python", "typeref": "typename:Tuple[str,dict]", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "S3Storage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_upload", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_upload(self, key: str, expires_in: int = 600) -> Tuple[str, dict]:$/", "language": "Python", "typeref": "typename:Tuple[str,dict]", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "StorageBackend", "scopeKind": "class"}], "hash": "eefebb86ea03328816ce57c714528d54", "format-version": 4, "code-base-name": "backend_api", "filename": "backend_api/src/services/storage_service.py"}