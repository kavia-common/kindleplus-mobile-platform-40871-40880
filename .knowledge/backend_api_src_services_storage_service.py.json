{"is_source_file": true, "format": "Python", "description": "This file implements storage backend abstractions and concrete classes for local filesystem, S3, and GCS in a storage service module.", "external_files": ["../core/config"], "external_methods": ["settings.STORAGE_BACKEND", "settings.S3_BUCKET", "settings.S3_REGION", "settings.S3_ACCESS_KEY_ID", "settings.S3_SECRET_ACCESS_KEY", "settings.GCS_BUCKET", "settings.GCS_CREDENTIALS_JSON", "settings.STORAGE_LOCAL_DIR"], "published": ["get_storage", "StorageBackend", "LocalStorage", "S3Storage", "GCSStorage"], "classes": [{"name": "StorageBackend", "description": "Protocol interface for storage backends, defining methods for presigning upload and download URLs."}, {"name": "LocalStorage", "description": "Implements StorageBackend for local filesystem, providing placeholder URLs for uploads and downloads."}, {"name": "S3Storage", "description": "Implements StorageBackend for AWS S3, generating presigned URLs for uploading and downloading."}, {"name": "GCSStorage", "description": "Implements StorageBackend for Google Cloud Storage, generating signed URLs for upload and download."}], "methods": [{"name": "Tuple[str,dict] presign_upload(self, key: str, expires_in: int = 600)", "description": "Generates a presigned URL for uploading a file, varies per storage backend.", "scope": "StorageBackend", "scopeKind": "class"}, {"name": "str presign_download(self, key: str, expires_in: int = 600)", "description": "Generates a URL for downloading a file, varies per storage backend.", "scope": "StorageBackend", "scopeKind": "class"}, {"name": "str _full_path(self, key: str)", "scope": "LocalStorage", "scopeKind": "class", "description": "unavailable"}, {"name": "StorageBackend get_storage()", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["settings.STORAGE_BACKEND", "os.makedirs", "datetime.now", "hashlib.sha256", "hmac.new", "urlencode"], "search-terms": ["storage backend", "presigned URLs", "S3", "GCS", "local storage", "storage service"], "state": 2, "file_id": 44, "knowledge_revision": 138, "git_revision": "55299610ad3eceeba2da47c02fa820d21e779ef8", "revision_history": [{"112": ""}, {"138": "55299610ad3eceeba2da47c02fa820d21e779ef8"}], "ctags": [{"_type": "tag", "name": "GCSStorage", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^class GCSStorage(StorageBackend):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "LocalStorage", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^class LocalStorage(StorageBackend):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "S3Storage", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^class S3Storage(StorageBackend):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "StorageBackend", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^class StorageBackend(Protocol):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_full_path", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def _full_path(self, key: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, key: str)", "scope": "LocalStorage", "scopeKind": "class"}, {"_type": "tag", "name": "get_storage", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^def get_storage() -> StorageBackend:$/", "language": "Python", "typeref": "typename:StorageBackend", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "presign_download", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_download(self, key: str, expires_in: int = 600) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "GCSStorage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_download", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_download(self, key: str, expires_in: int = 600) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "LocalStorage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_download", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_download(self, key: str, expires_in: int = 600) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "S3Storage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_download", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_download(self, key: str, expires_in: int = 600) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "StorageBackend", "scopeKind": "class"}, {"_type": "tag", "name": "presign_upload", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_upload(self, key: str, expires_in: int = 600) -> Tuple[str, dict]:$/", "language": "Python", "typeref": "typename:Tuple[str,dict]", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "GCSStorage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_upload", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_upload(self, key: str, expires_in: int = 600) -> Tuple[str, dict]:$/", "language": "Python", "typeref": "typename:Tuple[str,dict]", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "LocalStorage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_upload", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_upload(self, key: str, expires_in: int = 600) -> Tuple[str, dict]:$/", "language": "Python", "typeref": "typename:Tuple[str,dict]", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "S3Storage", "scopeKind": "class"}, {"_type": "tag", "name": "presign_upload", "path": "/home/kavia/workspace/code-generation/kindleplus-mobile-platform-40871-40880/backend_api/src/services/storage_service.py", "pattern": "/^    def presign_upload(self, key: str, expires_in: int = 600) -> Tuple[str, dict]:$/", "language": "Python", "typeref": "typename:Tuple[str,dict]", "kind": "member", "signature": "(self, key: str, expires_in: int = 600)", "scope": "StorageBackend", "scopeKind": "class"}], "hash": "d86b14ae93c2799ad3bb411328f8e5a0", "format-version": 4, "code-base-name": "backend_api", "filename": "backend_api/src/services/storage_service.py"}